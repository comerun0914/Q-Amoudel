<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue Router è°ƒè¯•æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-title {
            color: #1890ff;
            text-align: center;
            margin-bottom: 30px;
        }
        .test-button {
            background-color: #1890ff;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            width: 100%;
        }
        .test-button:hover {
            background-color: #40a9ff;
        }
        .result-box {
            background-color: #f6f8fa;
            border: 1px solid #e1e4e8;
            border-radius: 6px;
            padding: 16px;
            margin: 20px 0;
            max-height: 600px;
            overflow-y: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .status {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .status.success {
            background-color: #f6ffed;
            color: #52c41a;
            border: 1px solid #b7eb8f;
        }
        .status.error {
            background-color: #fff2f0;
            color: #ff4d4f;
            border: 1px solid #ffccc7;
        }
        .status.warning {
            background-color: #fffbe6;
            color: #faad14;
            border: 1px solid #ffe58f;
        }
        .info-box {
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            border-radius: 6px;
            padding: 16px;
            margin: 20px 0;
        }
        .info-box h4 {
            margin: 0 0 10px 0;
            color: #1890ff;
        }
        .debug-section {
            background-color: #fff7e6;
            border: 1px solid #ffd591;
            border-radius: 6px;
            padding: 16px;
            margin: 20px 0;
        }
        .debug-section h4 {
            margin: 0 0 10px 0;
            color: #fa8c16;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-title">Vue Router è°ƒè¯•æµ‹è¯•</h1>
        
        <div class="info-box">
            <h4>ğŸ“‹ æµ‹è¯•è¯´æ˜</h4>
            <p>è¿™ä¸ªé¡µé¢ç”¨äºè¯Šæ–­Vue Routeræ˜¯å¦æ­£å¸¸å·¥ä½œã€‚</p>
            <p><strong>æµ‹è¯•ç›®æ ‡ï¼š</strong>éªŒè¯è·¯ç”±è·³è½¬åŠŸèƒ½ã€è·¯ç”±å®ˆå«ã€æƒé™æ§åˆ¶ç­‰</p>
        </div>
        
        <button class="test-button" onclick="testRouterBasics()">
            ğŸ” åŸºç¡€è·¯ç”±åŠŸèƒ½æµ‹è¯•
        </button>
        
        <button class="test-button" onclick="testRouteGuards()">
            ğŸ›¡ï¸ è·¯ç”±å®ˆå«æµ‹è¯•
        </button>
        
        <button class="test-button" onclick="testNavigation()">
            ğŸš€ è·¯ç”±è·³è½¬æµ‹è¯•
        </button>
        
        <button class="test-button" onclick="testUserInfo()">
            ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯æµ‹è¯•
        </button>
        
        <div id="result" class="result-box">
            ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•Vue RouteråŠŸèƒ½...
        </div>
    </div>

    <script>
        function testRouterBasics() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<span class="status warning">â³ æ­£åœ¨æµ‹è¯•åŸºç¡€è·¯ç”±åŠŸèƒ½...</span>';
            
            try {
                // æ£€æŸ¥å½“å‰é¡µé¢çŠ¶æ€
                const currentPath = window.location.pathname;
                const currentUrl = window.location.href;
                const currentHash = window.location.hash;
                
                // æ£€æŸ¥æ˜¯å¦æœ‰Vue Routerçš„ç—•è¿¹
                const hasVueRouter = window.__VUE_ROUTER__ || 
                                   window.location.pathname.includes('/#/') ||
                                   document.querySelector('[data-v-router]');
                
                resultDiv.innerHTML = `
                    <span class="status success">âœ… åŸºç¡€è·¯ç”±åŠŸèƒ½æµ‹è¯•å®Œæˆ</span>
                    
                    <div class="debug-section">
                        <h4>ğŸŒ å½“å‰é¡µé¢çŠ¶æ€</h4>
                        - è·¯å¾„: ${currentPath}
                        - å®Œæ•´URL: ${currentUrl}
                        - Hash: ${currentHash}
                        - æ£€æµ‹åˆ°Vue Router: ${hasVueRouter ? 'æ˜¯' : 'å¦'}
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ” Vue Router æ£€æµ‹</h4>
                        - å…¨å±€Vue Routerå¯¹è±¡: ${window.__VUE_ROUTER__ ? 'å­˜åœ¨' : 'ä¸å­˜åœ¨'}
                        - Hashè·¯ç”±æ¨¡å¼: ${currentHash ? 'æ˜¯' : 'å¦'}
                        - Historyè·¯ç”±æ¨¡å¼: ${currentPath !== '/' ? 'æ˜¯' : 'å¦'}
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ“‹ æµ‹è¯•ç»“æœåˆ†æ</h4>
                        ${hasVueRouter ? 
                            'âœ… æ£€æµ‹åˆ°Vue Routerç¯å¢ƒï¼Œå¯ä»¥è¿›è¡Œè·¯ç”±æµ‹è¯•' : 
                            'âš ï¸ æœªæ£€æµ‹åˆ°Vue Routerç¯å¢ƒï¼Œå¯èƒ½ä¸åœ¨Vueåº”ç”¨ä¸­'
                        }
                    </div>
                `;
                
            } catch (error) {
                console.error('åŸºç¡€è·¯ç”±æµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `
                    <span class="status error">âŒ åŸºç¡€è·¯ç”±æµ‹è¯•å¼‚å¸¸</span>
                    
                    é”™è¯¯ç±»å‹: ${error.name}
                    é”™è¯¯ä¿¡æ¯: ${error.message}
                `;
            }
        }
        
        function testRouteGuards() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<span class="status warning">â³ æ­£åœ¨æµ‹è¯•è·¯ç”±å®ˆå«...</span>';
            
            try {
                // æ£€æŸ¥localStorageä¸­çš„è®¤è¯ä¿¡æ¯
                const token = localStorage.getItem('token') || localStorage.getItem('userToken');
                const userInfo = localStorage.getItem('userInfo') || localStorage.getItem('user_info');
                
                // å°è¯•è§£æç”¨æˆ·ä¿¡æ¯
                let parsedUserInfo = null;
                try {
                    if (userInfo) {
                        parsedUserInfo = JSON.parse(userInfo);
                    }
                } catch (e) {
                    console.log('ç”¨æˆ·ä¿¡æ¯è§£æå¤±è´¥:', e);
                }
                
                resultDiv.innerHTML = `
                    <span class="status success">âœ… è·¯ç”±å®ˆå«æµ‹è¯•å®Œæˆ</span>
                    
                    <div class="debug-section">
                        <h4>ğŸ” è®¤è¯ä¿¡æ¯æ£€æŸ¥</h4>
                        - Tokenå­˜åœ¨: ${!!token}
                        - Tokenå€¼: ${token ? (token.substring(0, 20) + '...') : 'æ— '}
                        - ç”¨æˆ·ä¿¡æ¯å­˜åœ¨: ${!!userInfo}
                        - ç”¨æˆ·ä¿¡æ¯è§£æ: ${parsedUserInfo ? 'æˆåŠŸ' : 'å¤±è´¥'}
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ‘¤ ç”¨æˆ·ä¿¡æ¯è¯¦æƒ…</h4>
                        ${parsedUserInfo ? 
                            `<pre>${JSON.stringify(parsedUserInfo, null, 2)}</pre>` : 
                            'æ— ç”¨æˆ·ä¿¡æ¯æˆ–è§£æå¤±è´¥'
                        }
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ“‹ è·¯ç”±å®ˆå«åˆ†æ</h4>
                        ${token && parsedUserInfo ? 
                            'âœ… è®¤è¯ä¿¡æ¯å®Œæ•´ï¼Œè·¯ç”±å®ˆå«åº”è¯¥å…è®¸è®¿é—®' : 
                            'âš ï¸ è®¤è¯ä¿¡æ¯ä¸å®Œæ•´ï¼Œè·¯ç”±å®ˆå«å¯èƒ½é˜»æ­¢è®¿é—®'
                        }
                    </div>
                `;
                
            } catch (error) {
                console.error('è·¯ç”±å®ˆå«æµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `
                    <span class="status error">âŒ è·¯ç”±å®ˆå«æµ‹è¯•å¼‚å¸¸</span>
                    
                    é”™è¯¯ç±»å‹: ${error.name}
                    é”™è¯¯ä¿¡æ¯: ${error.message}
                `;
            }
        }
        
        function testNavigation() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<span class="status warning">â³ æ­£åœ¨æµ‹è¯•è·¯ç”±è·³è½¬...</span>';
            
            try {
                // æµ‹è¯•ä¸åŒçš„è·³è½¬æ–¹å¼
                const testPaths = [
                    '/questionnaire/fill/123',
                    '/user',
                    '/home',
                    '/login'
                ];
                
                let navigationTest = '';
                testPaths.forEach(path => {
                    const fullUrl = window.location.origin + path;
                    navigationTest += `
                        <div style="margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            <strong>è·¯å¾„:</strong> ${path}<br>
                            <strong>å®Œæ•´URL:</strong> ${fullUrl}<br>
                            <button onclick="testSingleNavigation('${path}')" style="background: #1890ff; color: white; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;">
                                æµ‹è¯•è·³è½¬
                            </button>
                        </div>
                    `;
                });
                
                resultDiv.innerHTML = `
                    <span class="status success">âœ… è·¯ç”±è·³è½¬æµ‹è¯•å‡†å¤‡å®Œæˆ</span>
                    
                    <div class="debug-section">
                        <h4>ğŸ§ª è·³è½¬æµ‹è¯•</h4>
                        <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•ä¸åŒçš„è·¯ç”±è·³è½¬ï¼š</p>
                        ${navigationTest}
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ“‹ æµ‹è¯•è¯´æ˜</h4>
                        - å¦‚æœè·³è½¬æˆåŠŸï¼Œé¡µé¢åº”è¯¥å‘ç”Ÿå˜åŒ–
                        - å¦‚æœè·³è½¬å¤±è´¥ï¼Œå¯èƒ½çš„åŸå› ï¼š
                        <ul>
                            <li>Vue Routeræœªæ­£ç¡®åˆå§‹åŒ–</li>
                            <li>è·¯ç”±é…ç½®é”™è¯¯</li>
                            <li>è·¯ç”±å®ˆå«é˜»æ­¢è·³è½¬</li>
                            <li>ç›®æ ‡ç»„ä»¶ä¸å­˜åœ¨</li>
                        </ul>
                    </div>
                `;
                
            } catch (error) {
                console.error('è·¯ç”±è·³è½¬æµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `
                    <span class="status error">âŒ è·¯ç”±è·³è½¬æµ‹è¯•å¼‚å¸¸</span>
                    
                    é”™è¯¯ç±»å‹: ${error.name}
                    é”™è¯¯ä¿¡æ¯: ${error.message}
                `;
            }
        }
        
        function testSingleNavigation(path) {
            console.log('æµ‹è¯•è·³è½¬åˆ°:', path);
            
            try {
                // å°è¯•ä½¿ç”¨ä¸åŒçš„è·³è½¬æ–¹å¼
                if (path === '/login') {
                    // ç›´æ¥è·³è½¬åˆ°ç™»å½•é¡µ
                    window.location.href = path;
                } else {
                    // å°è¯•ä½¿ç”¨history API
                    window.history.pushState({}, '', path);
                    console.log('ä½¿ç”¨ history.pushState è·³è½¬åˆ°:', path);
                    
                    // è§¦å‘popstateäº‹ä»¶
                    window.dispatchEvent(new PopStateEvent('popstate'));
                }
            } catch (error) {
                console.error('è·³è½¬å¤±è´¥:', error);
                alert(`è·³è½¬å¤±è´¥: ${error.message}`);
            }
        }
        
        function testUserInfo() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<span class="status warning">â³ æ­£åœ¨æµ‹è¯•ç”¨æˆ·ä¿¡æ¯...</span>';
            
            try {
                // æ£€æŸ¥æ‰€æœ‰å¯èƒ½çš„å­˜å‚¨é”®
                const storageKeys = [
                    'token', 'userToken', 'accessToken',
                    'userInfo', 'user_info', 'user',
                    'auth', 'authentication'
                ];
                
                let storageInfo = '';
                storageKeys.forEach(key => {
                    const value = localStorage.getItem(key);
                    if (value) {
                        storageInfo += `
                            <div style="margin: 5px 0; padding: 5px; background: #f0f0f0; border-radius: 4px;">
                                <strong>${key}:</strong> ${value.substring(0, 50)}${value.length > 50 ? '...' : ''}
                            </div>
                        `;
                    }
                });
                
                resultDiv.innerHTML = `
                    <span class="status success">âœ… ç”¨æˆ·ä¿¡æ¯æµ‹è¯•å®Œæˆ</span>
                    
                    <div class="debug-section">
                        <h4>ğŸ’¾ æœ¬åœ°å­˜å‚¨æ£€æŸ¥</h4>
                        ${storageInfo || 'æœªæ‰¾åˆ°ä»»ä½•ç”¨æˆ·ç›¸å…³çš„å­˜å‚¨ä¿¡æ¯'}
                    </div>
                    
                    <div class="debug-section">
                        <h4>ğŸ” å­˜å‚¨åˆ†æ</h4>
                        ${storageInfo ? 
                            'âœ… æ‰¾åˆ°ç”¨æˆ·å­˜å‚¨ä¿¡æ¯ï¼Œå¯èƒ½å½±å“è·¯ç”±æƒé™' : 
                            'âš ï¸ æœªæ‰¾åˆ°ç”¨æˆ·å­˜å‚¨ä¿¡æ¯ï¼Œå¯èƒ½å¯¼è‡´è·¯ç”±æƒé™éªŒè¯å¤±è´¥'
                        }
                    </div>
                `;
                
            } catch (error) {
                console.error('ç”¨æˆ·ä¿¡æ¯æµ‹è¯•å¤±è´¥:', error);
                resultDiv.innerHTML = `
                    <span class="status error">âŒ ç”¨æˆ·ä¿¡æ¯æµ‹è¯•å¼‚å¸¸</span>
                    
                    é”™è¯¯ç±»å‹: ${error.name}
                    é”™è¯¯ä¿¡æ¯: ${error.message}
                `;
            }
        }
        
        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºæç¤º
        window.onload = function() {
            console.log('Vue Router è°ƒè¯•æµ‹è¯•é¡µé¢å·²åŠ è½½');
            console.log('å½“å‰é¡µé¢è·¯å¾„:', window.location.pathname);
            console.log('è¯·ç¡®ä¿Vueåº”ç”¨å·²æ­£ç¡®å¯åŠ¨');
        };
    </script>
</body>
</html>
