import{u as k,a as h,r as L,b as R,c as u,o as U,d as B,e as a,f as t,w as l,g as f,m as n,h as _}from"./index-90a1d7b0.js";import{_ as q}from"./_plugin-vue_export-helper-c27b6911.js";import{U as z}from"./UserOutlined-9d80a557.js";import{L as C}from"./LockOutlined-6b4a3ed2.js";const N={class:"login-page"},S={class:"login-container"},V={__name:"Login",setup(D){const v=k(),c=h(),p=L(!1),i=R({username:"",password:""}),b={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:20,message:"用户名长度在 2 到 20 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在 6 到 20 个字符",trigger:"blur"}]},w=async m=>{var e;try{p.value=!0;const s=await c.login({username:m.username,password:m.password});if(s.success){n.success(`登录成功！欢迎回来，${m.username}`);const o=((e=c.userInfo)==null?void 0:e.role)||0,r=c.getDefaultPageByRole(o);console.log("用户角色:",o,"跳转页面:",r);try{await v.push(r)}catch(d){console.error("路由跳转失败:",d),window.location.href=r}}else{const o=s.message||s.msg||"登录失败";n.error(o)}}catch(s){if(console.error("登录失败:",s),s.response){const o=s.response.status,r=s.response.data;o===401?n.error("用户名或密码错误"):o===500?n.error("服务器内部错误，请稍后重试"):n.error((r==null?void 0:r.message)||(r==null?void 0:r.msg)||`登录失败 (${o})`)}else s.request?n.error("无法连接到服务器，请检查网络连接"):n.error(s.message||"登录失败，请稍后重试")}finally{p.value=!1}},y=()=>{n.info("注册功能开发中...")};return(m,e)=>{const s=u("a-input"),o=u("a-form-item"),r=u("a-input-password"),d=u("a-button"),x=u("a-form");return U(),B("div",N,[a("div",S,[e[5]||(e[5]=a("div",{class:"logo"},[a("h1",null,"幼儿星")],-1)),t(x,{model:i,rules:b,onFinish:w,class:"login-form",layout:"vertical"},{default:l(()=>[t(o,{label:"用户名",name:"username"},{default:l(()=>[t(s,{value:i.username,"onUpdate:value":e[0]||(e[0]=g=>i.username=g),size:"large",placeholder:"请输入用户名"},{prefix:l(()=>[t(_(z))]),_:1},8,["value"])]),_:1}),t(o,{label:"密码",name:"password"},{default:l(()=>[t(r,{value:i.password,"onUpdate:value":e[1]||(e[1]=g=>i.password=g),size:"large",placeholder:"请输入密码"},{prefix:l(()=>[t(_(C))]),_:1},8,["value"])]),_:1}),t(o,null,{default:l(()=>[t(d,{type:"primary","html-type":"submit",size:"large",class:"btn-login",loading:p.value,block:""},{default:l(()=>e[2]||(e[2]=[f(" 登录 ",-1)])),_:1,__:[2]},8,["loading"])]),_:1}),e[3]||(e[3]=a("div",{class:"links"},[a("a",{href:"#",class:"link"},"忘记密码?"),a("a",{href:"#",class:"link"},"账号申诉")],-1))]),_:1,__:[3]},8,["model"]),a("div",{class:"register-link"},[a("p",null,[e[4]||(e[4]=f("还没有账号? ",-1)),a("a",{href:"#",onClick:y},"立即注册")])])])])}}},$=q(V,[["__scopeId","data-v-e9a457bf"]]);export{$ as default};
